| table_name                              | column_name                   | data_type                   | object_type       | definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| --------------------------------------- | ----------------------------- | --------------------------- | ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| vista_companias_periodo                 | periodo                       | character(6)                | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | rutcia                        | character varying           | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | nombrecia                     | character varying           | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | grupo                         | character varying           | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | total_primaclp                | numeric                     | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | total_primauf                 | numeric                     | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | crecimiento_clp               | numeric                     | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | crecimiento_uf                | numeric                     | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_companias_periodo                 | numero_de_corredores          | bigint                      | materialized_view |  SELECT i.periodo,
    i.rutcia,
    i.nombrecia,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.rutcia ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.nombrecia, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_concentracion_corredores          | periodo                       | character(6)                | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | rut                           | character varying           | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | total_clp                     | numeric                     | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | total_uf                      | numeric                     | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | participacion_porcentaje      | numeric                     | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | varianza_anual                | numeric                     | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_corredores          | hhi                           | numeric                     | materialized_view |  WITH agregados AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) AS total_clp,
            sum(i.primauf) AS total_uf
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), totales AS (
         SELECT agregados.periodo,
            sum(agregados.total_clp) AS total_periodo_clp
           FROM agregados
          GROUP BY agregados.periodo
        )
 SELECT a.periodo,
    a.rut,
    a.total_clp,
    a.total_uf,
    a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric) * 100::numeric AS participacion_porcentaje,
    (a.total_clp - lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo)) / NULLIF(lag(a.total_clp) OVER (PARTITION BY a.rut ORDER BY a.periodo), 0::numeric) * 100::numeric AS varianza_anual,
    sum(pow(a.total_clp / NULLIF(t.total_periodo_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi
   FROM agregados a
     LEFT JOIN totales t ON a.periodo = t.periodo
  GROUP BY a.periodo, a.rut, a.total_clp, a.total_uf, t.total_periodo_clp;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_concentracion_mercado             | periodo                       | character(6)                | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | grupo                         | character varying           | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | total_clp                     | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | total_uf                      | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | participacion_porcentaje      | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | varianza_anual                | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | hhi_grupo                     | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_concentracion_mercado             | hhi_general                   | numeric                     | materialized_view |  WITH total_periodo AS (
         SELECT vista_companias_periodo.periodo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp_periodo
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo
        ), participaciones_hhi_general AS (
         SELECT v.periodo,
            v.rutcia,
            v.total_primaclp,
            v.total_primaclp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
             JOIN total_periodo tp ON v.periodo = tp.periodo
        ), participaciones_hhi_grupo AS (
         SELECT v.periodo,
            v.grupo,
            v.rutcia,
            v.total_primaclp,
            sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo) AS total_grupo,
            v.total_primaclp / NULLIF(sum(v.total_primaclp) OVER (PARTITION BY v.periodo, v.grupo), 0::numeric) * 100::numeric AS participacion_pct
           FROM vista_companias_periodo v
        ), hhi_general_calc AS (
         SELECT participaciones_hhi_general.periodo,
            sum(power(participaciones_hhi_general.participacion_pct, 2::numeric)) AS hhi_general
           FROM participaciones_hhi_general
          GROUP BY participaciones_hhi_general.periodo
        ), hhi_grupo_calc AS (
         SELECT participaciones_hhi_grupo.periodo,
            participaciones_hhi_grupo.grupo,
            sum(power(participaciones_hhi_grupo.participacion_pct, 2::numeric)) AS hhi_grupo
           FROM participaciones_hhi_grupo
          GROUP BY participaciones_hhi_grupo.periodo, participaciones_hhi_grupo.grupo
        ), base_grupo AS (
         SELECT vista_companias_periodo.periodo,
            vista_companias_periodo.grupo,
            sum(vista_companias_periodo.total_primaclp) AS total_clp,
            sum(vista_companias_periodo.total_primauf) AS total_uf
           FROM vista_companias_periodo
          GROUP BY vista_companias_periodo.periodo, vista_companias_periodo.grupo
        ), base_con_var AS (
         SELECT bg.periodo,
            bg.grupo,
            bg.total_clp,
            bg.total_uf,
            tp.total_clp_periodo,
            bg.total_clp / NULLIF(tp.total_clp_periodo, 0::numeric) * 100::numeric AS participacion_porcentaje,
            (bg.total_clp - lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo)) / NULLIF(lag(bg.total_clp) OVER (PARTITION BY bg.grupo ORDER BY bg.periodo), 0::numeric) * 100::numeric AS varianza_anual
           FROM base_grupo bg
             JOIN total_periodo tp ON bg.periodo = tp.periodo
        )
 SELECT bcv.periodo,
    bcv.grupo,
    bcv.total_clp,
    bcv.total_uf,
    bcv.participacion_porcentaje,
    bcv.varianza_anual,
    hhi_grupo_calc.hhi_grupo,
    hhi_general_calc.hhi_general
   FROM base_con_var bcv
     LEFT JOIN hhi_grupo_calc ON bcv.periodo = hhi_grupo_calc.periodo AND bcv.grupo::text = hhi_grupo_calc.grupo::text
     LEFT JOIN hhi_general_calc ON bcv.periodo = hhi_general_calc.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_corredores_periodo                | periodo                       | character(6)                | materialized_view |  SELECT i.periodo,
    sum(i.primaclp) AS total_clp,
    sum(i.primaclp * 1000::numeric / uf_values.valor) AS total_uf,
    count(DISTINCT i.rut) AS num_corredores
   FROM intercia i
     JOIN uf_values ON uf_values.periodo::bpchar = i.periodo
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_corredores_periodo                | total_clp                     | numeric                     | materialized_view |  SELECT i.periodo,
    sum(i.primaclp) AS total_clp,
    sum(i.primaclp * 1000::numeric / uf_values.valor) AS total_uf,
    count(DISTINCT i.rut) AS num_corredores
   FROM intercia i
     JOIN uf_values ON uf_values.periodo::bpchar = i.periodo
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_corredores_periodo                | total_uf                      | numeric                     | materialized_view |  SELECT i.periodo,
    sum(i.primaclp) AS total_clp,
    sum(i.primaclp * 1000::numeric / uf_values.valor) AS total_uf,
    count(DISTINCT i.rut) AS num_corredores
   FROM intercia i
     JOIN uf_values ON uf_values.periodo::bpchar = i.periodo
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_corredores_periodo                | num_corredores                | bigint                      | materialized_view |  SELECT i.periodo,
    sum(i.primaclp) AS total_clp,
    sum(i.primaclp * 1000::numeric / uf_values.valor) AS total_uf,
    count(DISTINCT i.rut) AS num_corredores
   FROM intercia i
     JOIN uf_values ON uf_values.periodo::bpchar = i.periodo
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_corredores_region                 | periodo                       | character(6)                | materialized_view |  SELECT i.periodo,
    c.region,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.region
  ORDER BY i.periodo, c.region;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| vista_corredores_region                 | region                        | smallint                    | materialized_view |  SELECT i.periodo,
    c.region,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.region
  ORDER BY i.periodo, c.region;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| vista_corredores_region                 | numero_corredores             | bigint                      | materialized_view |  SELECT i.periodo,
    c.region,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.region
  ORDER BY i.periodo, c.region;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| vista_corredores_region                 | total_primaclp                | numeric                     | materialized_view |  SELECT i.periodo,
    c.region,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.region
  ORDER BY i.periodo, c.region;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| vista_corredores_region                 | total_primauf                 | numeric                     | materialized_view |  SELECT i.periodo,
    c.region,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.region
  ORDER BY i.periodo, c.region;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| vista_corredores_tipo_persona           | periodo                       | character(6)                | materialized_view |  SELECT i.periodo,
    c.tipo_persona,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.tipo_persona
  ORDER BY i.periodo, c.tipo_persona;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vista_corredores_tipo_persona           | tipo_persona                  | character(1)                | materialized_view |  SELECT i.periodo,
    c.tipo_persona,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.tipo_persona
  ORDER BY i.periodo, c.tipo_persona;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vista_corredores_tipo_persona           | numero_corredores             | bigint                      | materialized_view |  SELECT i.periodo,
    c.tipo_persona,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.tipo_persona
  ORDER BY i.periodo, c.tipo_persona;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vista_corredores_tipo_persona           | total_primaclp                | numeric                     | materialized_view |  SELECT i.periodo,
    c.tipo_persona,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.tipo_persona
  ORDER BY i.periodo, c.tipo_persona;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vista_corredores_tipo_persona           | total_primauf                 | numeric                     | materialized_view |  SELECT i.periodo,
    c.tipo_persona,
    count(DISTINCT i.rut) AS numero_corredores,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf
   FROM intercia i
     JOIN corredores c ON i.rut::text = c.rut::text
  GROUP BY i.periodo, c.tipo_persona
  ORDER BY i.periodo, c.tipo_persona;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vista_evolucion_corredores              | periodo                       | character(6)                | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rut_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rut
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rut_por_periodo.rut,
            min(rut_por_periodo.periodo) AS primer_periodo,
            max(rut_por_periodo.periodo) AS ultimo_periodo
           FROM rut_por_periodo
          GROUP BY rut_por_periodo.rut
        )
 SELECT rpp.periodo,
    rpp.rut,
    c.nombre,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) THEN 'salida'::text
            ELSE 'activo'::text
        END AS tipo_cambio
   FROM rut_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rut::text = pup.rut::text
     LEFT JOIN corredores c ON rpp.rut::text = c.rut::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_evolucion_corredores              | rut                           | character varying           | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rut_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rut
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rut_por_periodo.rut,
            min(rut_por_periodo.periodo) AS primer_periodo,
            max(rut_por_periodo.periodo) AS ultimo_periodo
           FROM rut_por_periodo
          GROUP BY rut_por_periodo.rut
        )
 SELECT rpp.periodo,
    rpp.rut,
    c.nombre,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) THEN 'salida'::text
            ELSE 'activo'::text
        END AS tipo_cambio
   FROM rut_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rut::text = pup.rut::text
     LEFT JOIN corredores c ON rpp.rut::text = c.rut::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_evolucion_corredores              | nombre                        | character varying(100)      | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rut_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rut
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rut_por_periodo.rut,
            min(rut_por_periodo.periodo) AS primer_periodo,
            max(rut_por_periodo.periodo) AS ultimo_periodo
           FROM rut_por_periodo
          GROUP BY rut_por_periodo.rut
        )
 SELECT rpp.periodo,
    rpp.rut,
    c.nombre,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) THEN 'salida'::text
            ELSE 'activo'::text
        END AS tipo_cambio
   FROM rut_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rut::text = pup.rut::text
     LEFT JOIN corredores c ON rpp.rut::text = c.rut::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_evolucion_corredores              | tipo_cambio                   | text                        | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rut_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rut
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rut_por_periodo.rut,
            min(rut_por_periodo.periodo) AS primer_periodo,
            max(rut_por_periodo.periodo) AS ultimo_periodo
           FROM rut_por_periodo
          GROUP BY rut_por_periodo.rut
        )
 SELECT rpp.periodo,
    rpp.rut,
    c.nombre,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) THEN 'salida'::text
            ELSE 'activo'::text
        END AS tipo_cambio
   FROM rut_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rut::text = pup.rut::text
     LEFT JOIN corredores c ON rpp.rut::text = c.rut::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_evolucion_corredores_agrupado     | periodo                       | character(6)                | materialized_view |  SELECT vista_evolucion_corredores.periodo,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'entrada'::text) AS num_entradas,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'salida'::text) AS num_salidas
   FROM vista_evolucion_corredores
  GROUP BY vista_evolucion_corredores.periodo
  ORDER BY vista_evolucion_corredores.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_evolucion_corredores_agrupado     | num_entradas                  | bigint                      | materialized_view |  SELECT vista_evolucion_corredores.periodo,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'entrada'::text) AS num_entradas,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'salida'::text) AS num_salidas
   FROM vista_evolucion_corredores
  GROUP BY vista_evolucion_corredores.periodo
  ORDER BY vista_evolucion_corredores.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_evolucion_corredores_agrupado     | num_salidas                   | bigint                      | materialized_view |  SELECT vista_evolucion_corredores.periodo,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'entrada'::text) AS num_entradas,
    count(*) FILTER (WHERE vista_evolucion_corredores.tipo_cambio = 'salida'::text) AS num_salidas
   FROM vista_evolucion_corredores
  GROUP BY vista_evolucion_corredores.periodo
  ORDER BY vista_evolucion_corredores.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_evolucion_mercado                 | periodo                       | character(6)                | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rutcia_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rutcia
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rutcia_por_periodo.rutcia,
            min(rutcia_por_periodo.periodo) AS primer_periodo,
            max(rutcia_por_periodo.periodo) AS ultimo_periodo
           FROM rutcia_por_periodo
          GROUP BY rutcia_por_periodo.rutcia
        )
 SELECT rpp.periodo,
    rpp.rutcia,
    c.nombrecia,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) AND NOT (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'salida'::text
            WHEN (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'fusion'::text
            ELSE 'activo'::text
        END AS tipo_cambio,
    COALESCE(( SELECT f.motivo
           FROM fusiones f
          WHERE f.rutcia_original::text = rpp.rutcia::text
         LIMIT 1), 'Motivo pendiente de definir'::text) AS motivo
   FROM rutcia_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rutcia::text = pup.rutcia::text
     LEFT JOIN companias c ON rpp.rutcia::text = c.rutcia::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_evolucion_mercado                 | rutcia                        | character varying           | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rutcia_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rutcia
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rutcia_por_periodo.rutcia,
            min(rutcia_por_periodo.periodo) AS primer_periodo,
            max(rutcia_por_periodo.periodo) AS ultimo_periodo
           FROM rutcia_por_periodo
          GROUP BY rutcia_por_periodo.rutcia
        )
 SELECT rpp.periodo,
    rpp.rutcia,
    c.nombrecia,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) AND NOT (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'salida'::text
            WHEN (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'fusion'::text
            ELSE 'activo'::text
        END AS tipo_cambio,
    COALESCE(( SELECT f.motivo
           FROM fusiones f
          WHERE f.rutcia_original::text = rpp.rutcia::text
         LIMIT 1), 'Motivo pendiente de definir'::text) AS motivo
   FROM rutcia_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rutcia::text = pup.rutcia::text
     LEFT JOIN companias c ON rpp.rutcia::text = c.rutcia::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_evolucion_mercado                 | nombrecia                     | character varying(50)       | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rutcia_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rutcia
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rutcia_por_periodo.rutcia,
            min(rutcia_por_periodo.periodo) AS primer_periodo,
            max(rutcia_por_periodo.periodo) AS ultimo_periodo
           FROM rutcia_por_periodo
          GROUP BY rutcia_por_periodo.rutcia
        )
 SELECT rpp.periodo,
    rpp.rutcia,
    c.nombrecia,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) AND NOT (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'salida'::text
            WHEN (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'fusion'::text
            ELSE 'activo'::text
        END AS tipo_cambio,
    COALESCE(( SELECT f.motivo
           FROM fusiones f
          WHERE f.rutcia_original::text = rpp.rutcia::text
         LIMIT 1), 'Motivo pendiente de definir'::text) AS motivo
   FROM rutcia_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rutcia::text = pup.rutcia::text
     LEFT JOIN companias c ON rpp.rutcia::text = c.rutcia::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_evolucion_mercado                 | tipo_cambio                   | text                        | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rutcia_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rutcia
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rutcia_por_periodo.rutcia,
            min(rutcia_por_periodo.periodo) AS primer_periodo,
            max(rutcia_por_periodo.periodo) AS ultimo_periodo
           FROM rutcia_por_periodo
          GROUP BY rutcia_por_periodo.rutcia
        )
 SELECT rpp.periodo,
    rpp.rutcia,
    c.nombrecia,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) AND NOT (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'salida'::text
            WHEN (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'fusion'::text
            ELSE 'activo'::text
        END AS tipo_cambio,
    COALESCE(( SELECT f.motivo
           FROM fusiones f
          WHERE f.rutcia_original::text = rpp.rutcia::text
         LIMIT 1), 'Motivo pendiente de definir'::text) AS motivo
   FROM rutcia_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rutcia::text = pup.rutcia::text
     LEFT JOIN companias c ON rpp.rutcia::text = c.rutcia::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_evolucion_mercado                 | motivo                        | text                        | materialized_view |  WITH periodos_extremos AS (
         SELECT min(intercia.periodo) AS min_periodo,
            max(intercia.periodo) AS max_periodo
           FROM intercia
        ), rutcia_por_periodo AS (
         SELECT DISTINCT intercia.periodo,
            intercia.rutcia
           FROM intercia
        ), primer_ultimo_periodo AS (
         SELECT rutcia_por_periodo.rutcia,
            min(rutcia_por_periodo.periodo) AS primer_periodo,
            max(rutcia_por_periodo.periodo) AS ultimo_periodo
           FROM rutcia_por_periodo
          GROUP BY rutcia_por_periodo.rutcia
        )
 SELECT rpp.periodo,
    rpp.rutcia,
    c.nombrecia,
        CASE
            WHEN rpp.periodo = (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'activo'::text
            WHEN rpp.periodo = pup.primer_periodo AND rpp.periodo > (( SELECT periodos_extremos.min_periodo
               FROM periodos_extremos)) THEN 'entrada'::text
            WHEN rpp.periodo = pup.ultimo_periodo AND rpp.periodo < (( SELECT periodos_extremos.max_periodo
               FROM periodos_extremos)) AND NOT (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'salida'::text
            WHEN (EXISTS ( SELECT 1
               FROM fusiones f
              WHERE f.rutcia_original::text = rpp.rutcia::text)) THEN 'fusion'::text
            ELSE 'activo'::text
        END AS tipo_cambio,
    COALESCE(( SELECT f.motivo
           FROM fusiones f
          WHERE f.rutcia_original::text = rpp.rutcia::text
         LIMIT 1), 'Motivo pendiente de definir'::text) AS motivo
   FROM rutcia_por_periodo rpp
     JOIN primer_ultimo_periodo pup ON rpp.rutcia::text = pup.rutcia::text
     LEFT JOIN companias c ON rpp.rutcia::text = c.rutcia::text;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_grupos_periodo                    | periodo                       | character(6)                | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | grupo                         | character varying           | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | total_primaclp                | numeric                     | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | total_primauf                 | numeric                     | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | crecimiento_clp               | numeric                     | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | crecimiento_uf                | numeric                     | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vista_grupos_periodo                    | numero_de_corredores_unicos   | bigint                      | materialized_view |  SELECT i.periodo,
    i.grupo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    (sum(i.primaclp) - lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primaclp)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
    (sum(i.primauf) - lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo)) / NULLIF(lag(sum(i.primauf)) OVER (PARTITION BY i.grupo ORDER BY i.periodo), 0::numeric) * 100::numeric AS crecimiento_uf,
    count(DISTINCT i.rut) AS numero_de_corredores_unicos
   FROM intercia i
  GROUP BY i.periodo, i.grupo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| accesos_pkey                            | id                            | uuid                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| actores_salientes_id_seq                | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| actores_salientes_id_seq                | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| actores_salientes_id_seq                | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| actores_salientes_pkey                  | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| companias_id_seq                        | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| companias_id_seq                        | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| companias_id_seq                        | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| companias_pkey                          | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| companias_rut_key                       | rut                           | character varying(10)       | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_id_seq                       | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_id_seq                       | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_id_seq                       | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_master_id_seq                | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_master_id_seq                | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_master_id_seq                | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_master_pkey                  | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_master_rut_key               | rut                           | character varying(10)       | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| corredores_pkey                         | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fusiones_id_seq                         | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fusiones_id_seq                         | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fusiones_id_seq                         | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| fusiones_pkey                           | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_companias_rutcia                    | rutcia                        | character varying(10)       | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_corredores_rut                      | rut                           | character varying(10)       | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_periodo                    | periodo                       | character(6)                | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_periodo_rut                | periodo                       | character(6)                | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_periodo_rut                | rut                           | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_rut                        | rut                           | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_rutcia_periodo             | rutcia                        | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_intercia_rutcia_periodo             | periodo                       | character(6)                | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_prodramo_periodo_rut                | periodo                       | character(6)                | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_prodramo_periodo_rut                | rut                           | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| idx_prodramo_primauf                    | primauf                       | numeric(15,2)               | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| pagos_pkey                              | id                            | uuid                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| periodos_id_seq                         | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| periodos_id_seq                         | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| periodos_id_seq                         | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| periodos_periodo_key                    | periodo                       | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| periodos_pkey                           | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_id_seq                       | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_id_seq                       | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_id_seq                       | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_pkey                         | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_ramos_id_seq                 | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_ramos_id_seq                 | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_ramos_id_seq                 | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| produccion_ramos_pkey                   | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| productos_codigo_key                    | codigo                        | text                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| productos_pkey                          | id                            | uuid                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ramos_id_seq                            | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ramos_id_seq                            | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ramos_id_seq                            | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ramos_master_codigo_key                 | codigo                        | character varying(10)       | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| registro_empresa_pkey                   | id                            | uuid                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| reporte_individual_pkey                 | id                            | uuid                        | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| uf_values_date_key                      | date                          | character varying           | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| uf_values_id_seq                        | last_value                    | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| uf_values_id_seq                        | log_cnt                       | bigint                      | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| uf_values_id_seq                        | is_called                     | boolean                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| uf_values_pkey                          | id                            | integer                     | other             | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| accesos                                 | id                            | uuid                        | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | user_id                       | text                        | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | producto_id                   | uuid                        | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | modulo                        | text                        | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | fecha_inicio                  | timestamp without time zone | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | fecha_fin                     | timestamp without time zone | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| accesos                                 | activo                        | boolean                     | table             | Table: id uuid, user_id text, producto_id uuid, modulo text, fecha_inicio timestamp without time zone, fecha_fin timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| actores_salientes                       | id                            | integer                     | table             | Table: id integer, rutcia character varying, nombrecia character varying, motivo text, fecha_salida date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| actores_salientes                       | rutcia                        | character varying(10)       | table             | Table: id integer, rutcia character varying, nombrecia character varying, motivo text, fecha_salida date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| actores_salientes                       | nombrecia                     | character varying(100)      | table             | Table: id integer, rutcia character varying, nombrecia character varying, motivo text, fecha_salida date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| actores_salientes                       | motivo                        | text                        | table             | Table: id integer, rutcia character varying, nombrecia character varying, motivo text, fecha_salida date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| actores_salientes                       | fecha_salida                  | date                        | table             | Table: id integer, rutcia character varying, nombrecia character varying, motivo text, fecha_salida date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| companias                               | id                            | integer                     | table             | Table: id integer, rutcia character varying, nombrecia character varying, grupo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| companias                               | rutcia                        | character varying(10)       | table             | Table: id integer, rutcia character varying, nombrecia character varying, grupo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| companias                               | nombrecia                     | character varying(50)       | table             | Table: id integer, rutcia character varying, nombrecia character varying, grupo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| companias                               | grupo                         | character varying           | table             | Table: id integer, rutcia character varying, nombrecia character varying, grupo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| corredores                              | id                            | integer                     | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | rut                           | character varying(10)       | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | nombre                        | character varying(100)      | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | telefono                      | character varying(15)       | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | domicilio                     | character varying(100)      | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | ciudad                        | character varying(50)       | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | region                        | smallint                    | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| corredores                              | tipo_persona                  | character(1)                | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| fusiones                                | id                            | integer                     | table             | Table: id integer, rutcia_original character varying, rutcia_nueva character varying, fecha_fusion date, motivo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fusiones                                | rutcia_original               | character varying(10)       | table             | Table: id integer, rutcia_original character varying, rutcia_nueva character varying, fecha_fusion date, motivo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fusiones                                | rutcia_nueva                  | character varying(10)       | table             | Table: id integer, rutcia_original character varying, rutcia_nueva character varying, fecha_fusion date, motivo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fusiones                                | fecha_fusion                  | date                        | table             | Table: id integer, rutcia_original character varying, rutcia_nueva character varying, fecha_fusion date, motivo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fusiones                                | motivo                        | text                        | table             | Table: id integer, rutcia_original character varying, rutcia_nueva character varying, fecha_fusion date, motivo text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| identifi                                | id                            | integer                     | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | rut                           | character varying           | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | nombre                        | character varying(100)      | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | telefono                      | character varying(15)       | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | domicilio                     | character varying(100)      | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | ciudad                        | character varying(50)       | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | region                        | smallint                    | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | tipo_persona                  | character(1)                | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| identifi                                | periodo                       | character(6)                | table             | Table: id integer, rut character varying, nombre character varying, telefono character varying, domicilio character varying, ciudad character varying, region smallint, tipo_persona character, periodo character                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| intercia                                | id                            | integer                     | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | periodo                       | character(6)                | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | rut                           | character varying           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | rutcia                        | character varying           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | ........pg.dropped.5........  | -                           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | primaclp                      | numeric(15,2)               | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | ........pg.dropped.7........  | -                           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | ........pg.dropped.8........  | -                           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | nombrecia                     | character varying           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | grupo                         | character varying           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | signo                         | character varying           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | primauf                       | numeric                     | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| intercia                                | ........pg.dropped.13........ | -                           | table             | Table: id integer, periodo character, rut character varying, rutcia character varying, primaclp numeric, nombrecia character varying, grupo character varying, signo character varying, primauf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| pagos                                   | id                            | uuid                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | user_id                       | text                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | rut                           | character varying           | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | producto_id                   | uuid                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | orden_comercio                | text                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | amount                        | numeric(10,2)               | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | estado                        | text                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | fecha_creacion                | timestamp without time zone | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | token                         | text                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| pagos                                   | url_pago                      | text                        | table             | Table: id uuid, user_id text, rut character varying, producto_id uuid, orden_comercio text, amount numeric, estado text, fecha_creacion timestamp without time zone, token text, url_pago text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| periodos                                | id                            | integer                     | table             | Table: id integer, periodo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| periodos                                | periodo                       | character varying           | table             | Table: id integer, periodo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| prodramo                                | id                            | integer                     | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | periodo                       | character(6)                | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | ........pg.dropped.3........  | -                           | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | grupo                         | smallint                    | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | cod                           | character varying           | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | primaclp                      | numeric(15,2)               | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | primauf                       | numeric(15,2)               | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | rut                           | character varying           | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| prodramo                                | signo                         | character varying           | table             | Table: id integer, periodo character, grupo smallint, cod character varying, primaclp numeric, primauf numeric, rut character varying, signo character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| productos                               | id                            | uuid                        | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| productos                               | codigo                        | text                        | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| productos                               | nombre                        | text                        | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| productos                               | descripcion                   | text                        | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| productos                               | precio_neto                   | numeric(10,2)               | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| productos                               | precio_bruto                  | numeric(10,2)               | table             | Table: id uuid, codigo text, nombre text, descripcion text, precio_neto numeric, precio_bruto numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ramos                                   | id                            | smallint                    | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | codigo                        | character varying(10)       | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | ramo                          | character varying(100)      | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | grupo                         | character varying(50)       | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | subgrupo                      | character varying           | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | cod                           | character varying           | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ramos                                   | codsg                         | character varying           | table             | Table: id smallint, codigo character varying, ramo character varying, grupo character varying, subgrupo character varying, cod character varying, codsg character varying                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| registro_empresa                        | id                            | uuid                        | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| registro_empresa                        | user_id                       | text                        | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| registro_empresa                        | email                         | text                        | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| registro_empresa                        | empresa                       | text                        | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| registro_empresa                        | rut_empresa                   | text                        | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| registro_empresa                        | created_at                    | timestamp without time zone | table             | Table: id uuid, user_id text, email text, empresa text, rut_empresa text, created_at timestamp without time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| reporte_individual                      | id                            | uuid                        | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | user_id                       | text                        | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | rut                           | character varying           | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | periodo                       | text                        | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | data                          | jsonb                       | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | fecha_generacion              | timestamp without time zone | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | fecha_expiracion              | timestamp without time zone | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| reporte_individual                      | activo                        | boolean                     | table             | Table: id uuid, user_id text, rut character varying, periodo text, data jsonb, fecha_generacion timestamp without time zone, fecha_expiracion timestamp without time zone, activo boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| temp_concentracion_mercado              | periodo                       | character(6)                | table             | Table: periodo character, grupo character varying, total_clp numeric, total_uf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| temp_concentracion_mercado              | grupo                         | character varying           | table             | Table: periodo character, grupo character varying, total_clp numeric, total_uf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| temp_concentracion_mercado              | total_clp                     | numeric                     | table             | Table: periodo character, grupo character varying, total_clp numeric, total_uf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| temp_concentracion_mercado              | total_uf                      | numeric                     | table             | Table: periodo character, grupo character varying, total_clp numeric, total_uf numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| uf_values                               | id                            | integer                     | table             | Table: id integer, periodo character varying, valor numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| uf_values                               | periodo                       | character varying           | table             | Table: id integer, periodo character varying, valor numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| uf_values                               | valor                         | numeric(10,2)               | table             | Table: id integer, periodo character varying, valor numeric                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| indicadores_generales_corredor          | rut                           | character varying           | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | periodo                       | character(6)                | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | total_primaclp                | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | total_primauf                 | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | crecimiento_clp               | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | crecimiento_uf                | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | hhi_ramos                     | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | hhi_companias                 | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | participacion_clp             | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | variacion_clp_pp              | numeric                     | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | num_companias                 | bigint                      | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | num_ramos                     | bigint                      | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| indicadores_generales_corredor          | ranking_general               | bigint                      | view              |  WITH totales AS (
         SELECT i.rut,
            i.periodo,
            sum(i.primaclp) AS total_primaclp,
            sum(i.primauf) AS total_primauf,
            count(DISTINCT i.rutcia) AS num_companias,
            count(DISTINCT p_1.cod) AS num_ramos
           FROM intercia i
             LEFT JOIN prodramo p_1 ON i.rut::text = p_1.rut::text AND i.periodo = p_1.periodo
          GROUP BY i.rut, i.periodo
        ), crecimiento AS (
         SELECT totales.rut,
            totales.periodo,
            totales.total_primaclp,
            totales.total_primauf,
            lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primaclp_anterior,
            lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo) AS primauf_anterior,
            (totales.total_primaclp - lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primaclp) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_clp,
            (totales.total_primauf - lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo)) / NULLIF(lag(totales.total_primauf) OVER (PARTITION BY totales.rut ORDER BY totales.periodo), 0::numeric) * 100::numeric AS crecimiento_uf
           FROM totales
        ), hhi_data AS (
         SELECT p_1.rut,
            p_1.periodo,
            p_1.primaclp,
            sum(p_1.primaclp) OVER (PARTITION BY p_1.rut, p_1.periodo) AS total_primaclp_rut,
            i.primaclp AS primaclp_compania,
            sum(i.primaclp) OVER (PARTITION BY i.rut, i.periodo) AS total_primaclp_compania
           FROM prodramo p_1
             LEFT JOIN intercia i ON p_1.rut::text = i.rut::text AND p_1.periodo = i.periodo
        ), hhi AS (
         SELECT hhi_data.rut,
            hhi_data.periodo,
            sum(pow(hhi_data.primaclp / NULLIF(hhi_data.total_primaclp_rut, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_ramos,
            sum(pow(hhi_data.primaclp_compania / NULLIF(hhi_data.total_primaclp_compania, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_companias
           FROM hhi_data
          GROUP BY hhi_data.rut, hhi_data.periodo
        ), participacion AS (
         SELECT i.periodo,
            i.rut,
            sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) * 100::numeric AS participacion_clp,
            (sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo)) - lag(sum(i.primaclp) / (( SELECT sum(intercia.primaclp) AS sum
                   FROM intercia
                  WHERE intercia.periodo = i.periodo))) OVER (PARTITION BY i.rut ORDER BY i.periodo)) * 100::numeric AS variacion_clp_pp
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), ranking AS (
         SELECT rg.rut,
            rg.periodo,
            rg.ranking_produccion AS ranking_general
           FROM ranking_general rg
        )
 SELECT t.rut,
    t.periodo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    c.crecimiento_uf,
    h.hhi_ramos,
    h.hhi_companias,
    p.participacion_clp,
    p.variacion_clp_pp,
    t.num_companias,
    t.num_ramos,
    r.ranking_general
   FROM totales t
     LEFT JOIN crecimiento c ON t.rut::text = c.rut::text AND t.periodo = c.periodo
     LEFT JOIN hhi h ON t.rut::text = h.rut::text AND t.periodo = h.periodo
     LEFT JOIN participacion p ON t.rut::text = p.rut::text AND t.periodo = p.periodo
     LEFT JOIN ranking r ON t.rut::text = r.rut::text AND t.periodo = r.periodo; |
| memoria_anual_ramos                     | codigo                        | character varying(10)       | view              |  SELECT r.codigo,
    r.ramo,
    sum(p.primaclp) AS total_clp,
    sum(p.primauf) AS total_uf
   FROM ramos r
     LEFT JOIN prodramo p ON r.codigo::text = p.cod::text
  GROUP BY r.codigo, r.ramo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| memoria_anual_ramos                     | ramo                          | character varying(100)      | view              |  SELECT r.codigo,
    r.ramo,
    sum(p.primaclp) AS total_clp,
    sum(p.primauf) AS total_uf
   FROM ramos r
     LEFT JOIN prodramo p ON r.codigo::text = p.cod::text
  GROUP BY r.codigo, r.ramo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| memoria_anual_ramos                     | total_clp                     | numeric                     | view              |  SELECT r.codigo,
    r.ramo,
    sum(p.primaclp) AS total_clp,
    sum(p.primauf) AS total_uf
   FROM ramos r
     LEFT JOIN prodramo p ON r.codigo::text = p.cod::text
  GROUP BY r.codigo, r.ramo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| memoria_anual_ramos                     | total_uf                      | numeric                     | view              |  SELECT r.codigo,
    r.ramo,
    sum(p.primaclp) AS total_clp,
    sum(p.primauf) AS total_uf
   FROM ramos r
     LEFT JOIN prodramo p ON r.codigo::text = p.cod::text
  GROUP BY r.codigo, r.ramo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_companias                       | periodo                       | character(6)                | view              |  SELECT i.periodo,
    i.rutcia,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo, i.rutcia ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_companias                       | rutcia                        | character varying           | view              |  SELECT i.periodo,
    i.rutcia,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo, i.rutcia ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_companias                       | rut                           | character varying           | view              |  SELECT i.periodo,
    i.rutcia,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo, i.rutcia ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_companias                       | total_primaclp                | numeric                     | view              |  SELECT i.periodo,
    i.rutcia,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo, i.rutcia ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_companias                       | ranking_produccion            | bigint                      | view              |  SELECT i.periodo,
    i.rutcia,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo, i.rutcia ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rutcia, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ranking_general                         | periodo                       | character(6)                | view              |  SELECT i.periodo,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ranking_general                         | rut                           | character varying           | view              |  SELECT i.periodo,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ranking_general                         | total_primaclp                | numeric                     | view              |  SELECT i.periodo,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ranking_general                         | ranking_produccion            | bigint                      | view              |  SELECT i.periodo,
    i.rut,
    sum(i.primaclp) AS total_primaclp,
    rank() OVER (PARTITION BY i.periodo ORDER BY (sum(i.primaclp)) DESC) AS ranking_produccion
   FROM intercia i
  GROUP BY i.periodo, i.rut;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ranking_ramos                           | periodo                       | character(6)                | view              |  SELECT p.periodo,
    p.cod AS ramo_cod,
    p.rut,
    p.primaclp,
    rank() OVER (PARTITION BY p.periodo, p.cod ORDER BY p.primaclp DESC) AS ranking_produccion
   FROM prodramo p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ranking_ramos                           | ramo_cod                      | character varying           | view              |  SELECT p.periodo,
    p.cod AS ramo_cod,
    p.rut,
    p.primaclp,
    rank() OVER (PARTITION BY p.periodo, p.cod ORDER BY p.primaclp DESC) AS ranking_produccion
   FROM prodramo p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ranking_ramos                           | rut                           | character varying           | view              |  SELECT p.periodo,
    p.cod AS ramo_cod,
    p.rut,
    p.primaclp,
    rank() OVER (PARTITION BY p.periodo, p.cod ORDER BY p.primaclp DESC) AS ranking_produccion
   FROM prodramo p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ranking_ramos                           | primaclp                      | numeric(15,2)               | view              |  SELECT p.periodo,
    p.cod AS ramo_cod,
    p.rut,
    p.primaclp,
    rank() OVER (PARTITION BY p.periodo, p.cod ORDER BY p.primaclp DESC) AS ranking_produccion
   FROM prodramo p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ranking_ramos                           | ranking_produccion            | bigint                      | view              |  SELECT p.periodo,
    p.cod AS ramo_cod,
    p.rut,
    p.primaclp,
    rank() OVER (PARTITION BY p.periodo, p.cod ORDER BY p.primaclp DESC) AS ranking_produccion
   FROM prodramo p;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vista_concentracion_corredores_por_ramo | periodo                       | character(6)                | view              |  WITH total_por_ramo_periodo AS (
         SELECT prodramo.periodo,
            prodramo.cod,
            sum(prodramo.primaclp) AS total_clp
           FROM prodramo
          GROUP BY prodramo.periodo, prodramo.cod
        )
 SELECT p.periodo,
    p.cod AS ramo_cod,
    sum(power(p.primaclp / NULLIF(tpr.total_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_corredores_ramo
   FROM prodramo p
     JOIN total_por_ramo_periodo tpr ON p.periodo = tpr.periodo AND p.cod::text = tpr.cod::text
  GROUP BY p.periodo, p.cod;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_concentracion_corredores_por_ramo | ramo_cod                      | character varying           | view              |  WITH total_por_ramo_periodo AS (
         SELECT prodramo.periodo,
            prodramo.cod,
            sum(prodramo.primaclp) AS total_clp
           FROM prodramo
          GROUP BY prodramo.periodo, prodramo.cod
        )
 SELECT p.periodo,
    p.cod AS ramo_cod,
    sum(power(p.primaclp / NULLIF(tpr.total_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_corredores_ramo
   FROM prodramo p
     JOIN total_por_ramo_periodo tpr ON p.periodo = tpr.periodo AND p.cod::text = tpr.cod::text
  GROUP BY p.periodo, p.cod;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_concentracion_corredores_por_ramo | hhi_corredores_ramo           | numeric                     | view              |  WITH total_por_ramo_periodo AS (
         SELECT prodramo.periodo,
            prodramo.cod,
            sum(prodramo.primaclp) AS total_clp
           FROM prodramo
          GROUP BY prodramo.periodo, prodramo.cod
        )
 SELECT p.periodo,
    p.cod AS ramo_cod,
    sum(power(p.primaclp / NULLIF(tpr.total_clp, 0::numeric), 2::numeric)) * 10000::numeric AS hhi_corredores_ramo
   FROM prodramo p
     JOIN total_por_ramo_periodo tpr ON p.periodo = tpr.periodo AND p.cod::text = tpr.cod::text
  GROUP BY p.periodo, p.cod;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vista_concentracion_ramos               | periodo                       | character(6)                | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_concentracion_ramos               | hhi_general                   | numeric                     | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_concentracion_ramos               | grupo                         | character varying(50)       | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_concentracion_ramos               | hhi_grupo                     | numeric                     | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_concentracion_ramos               | subgrupo                      | character varying           | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_concentracion_ramos               | hhi_subgrupo                  | numeric                     | view              |  WITH hhi_general AS (
         SELECT vista_ramos_periodo.periodo,
            sum(power(vista_ramos_periodo.participacion_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo
        ), hhi_grupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.grupo,
            sum(power(vista_ramos_periodo.participacion_grupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.grupo
        ), hhi_subgrupo AS (
         SELECT vista_ramos_periodo.periodo,
            vista_ramos_periodo.subgrupo,
            sum(power(vista_ramos_periodo.participacion_subgrupo_clp, 2::numeric)) AS hhi
           FROM vista_ramos_periodo
          GROUP BY vista_ramos_periodo.periodo, vista_ramos_periodo.subgrupo
        )
 SELECT g.periodo,
    g.hhi AS hhi_general,
    gr.grupo,
    gr.hhi AS hhi_grupo,
    sg.subgrupo,
    sg.hhi AS hhi_subgrupo
   FROM hhi_general g
     LEFT JOIN hhi_grupo gr ON g.periodo = gr.periodo
     LEFT JOIN hhi_subgrupo sg ON g.periodo = sg.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vista_mercado_periodo                   | periodo                       | character(6)                | view              |  SELECT i.periodo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    count(DISTINCT i.rut) AS total_corredores,
    count(DISTINCT i.rutcia) AS total_companias
   FROM intercia i
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_mercado_periodo                   | total_primaclp                | numeric                     | view              |  SELECT i.periodo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    count(DISTINCT i.rut) AS total_corredores,
    count(DISTINCT i.rutcia) AS total_companias
   FROM intercia i
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_mercado_periodo                   | total_primauf                 | numeric                     | view              |  SELECT i.periodo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    count(DISTINCT i.rut) AS total_corredores,
    count(DISTINCT i.rutcia) AS total_companias
   FROM intercia i
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_mercado_periodo                   | total_corredores              | bigint                      | view              |  SELECT i.periodo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    count(DISTINCT i.rut) AS total_corredores,
    count(DISTINCT i.rutcia) AS total_companias
   FROM intercia i
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_mercado_periodo                   | total_companias               | bigint                      | view              |  SELECT i.periodo,
    sum(i.primaclp) AS total_primaclp,
    sum(i.primauf) AS total_primauf,
    count(DISTINCT i.rut) AS total_corredores,
    count(DISTINCT i.rutcia) AS total_companias
   FROM intercia i
  GROUP BY i.periodo;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| vista_ramos_periodo                     | periodo                       | character(6)                | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | cod                           | character varying(10)       | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | ramo                          | character varying(100)      | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | grupo                         | character varying(50)       | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | subgrupo                      | character varying           | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | total_primaclp                | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | total_primauf                 | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | crecimiento_clp               | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | participacion_clp             | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | variacion_clp_pp              | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | participacion_grupo_clp       | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | participacion_subgrupo_clp    | numeric                     | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | ranking_general               | bigint                      | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | ranking_grupo                 | bigint                      | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_ramos_periodo                     | ranking_subgrupo              | bigint                      | view              |  WITH totales AS (
         SELECT p_1.periodo,
            r_1.codigo AS cod,
            r_1.ramo,
            r_1.grupo,
            r_1.subgrupo,
            sum(p_1.primaclp) AS total_primaclp,
            sum(p_1.primauf) AS total_primauf
           FROM prodramo p_1
             LEFT JOIN ramos r_1 ON p_1.cod::text = r_1.cod::text
          GROUP BY p_1.periodo, r_1.codigo, r_1.ramo, r_1.grupo, r_1.subgrupo
        ), crecimiento AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.subgrupo,
            t_1.total_primaclp,
            lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo) AS primaclp_anterior,
            (t_1.total_primaclp - lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) / NULLIF(lag(t_1.total_primaclp) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo), 0::numeric) * 100::numeric AS crecimiento_clp
           FROM totales t_1
        ), participacion AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) * 100::numeric AS participacion_clp,
            (t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo)) - lag(t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo))) OVER (PARTITION BY t_1.cod ORDER BY t_1.periodo)) * 100::numeric AS variacion_clp_pp
           FROM totales t_1
        ), participacion_grupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.grupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.grupo::text = t_1.grupo::text)) * 100::numeric AS participacion_grupo_clp
           FROM totales t_1
        ), participacion_subgrupo AS (
         SELECT t_1.periodo,
            t_1.cod,
            t_1.subgrupo,
            t_1.total_primaclp / (( SELECT sum(totales.total_primaclp) AS sum
                   FROM totales
                  WHERE totales.periodo = t_1.periodo AND totales.subgrupo::text = t_1.subgrupo::text)) * 100::numeric AS participacion_subgrupo_clp
           FROM totales t_1
        ), ranking AS (
         SELECT t_1.periodo,
            t_1.cod,
            rank() OVER (PARTITION BY t_1.periodo ORDER BY t_1.total_primaclp DESC) AS ranking_general,
            rank() OVER (PARTITION BY t_1.periodo, t_1.grupo ORDER BY t_1.total_primaclp DESC) AS ranking_grupo,
            rank() OVER (PARTITION BY t_1.periodo, t_1.subgrupo ORDER BY t_1.total_primaclp DESC) AS ranking_subgrupo
           FROM totales t_1
        )
 SELECT t.periodo,
    t.cod,
    t.ramo,
    t.grupo,
    t.subgrupo,
    t.total_primaclp,
    t.total_primauf,
    c.crecimiento_clp,
    p.participacion_clp,
    p.variacion_clp_pp,
    pg.participacion_grupo_clp,
    ps.participacion_subgrupo_clp,
    r.ranking_general,
    r.ranking_grupo,
    r.ranking_subgrupo
   FROM totales t
     LEFT JOIN crecimiento c ON t.periodo = c.periodo AND t.cod::text = c.cod::text
     LEFT JOIN participacion p ON t.periodo = p.periodo AND t.cod::text = p.cod::text
     LEFT JOIN participacion_grupo pg ON t.periodo = pg.periodo AND t.cod::text = pg.cod::text
     LEFT JOIN participacion_subgrupo ps ON t.periodo = ps.periodo AND t.cod::text = ps.cod::text
     LEFT JOIN ranking r ON t.periodo = r.periodo AND t.cod::text = r.cod::text;                                                                        |
| vista_segmentos_companias               | periodo                       | character(6)                | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rutcia,
            c.nombrecia,
            i.primauf,
                CASE
                    WHEN i.primauf < (e.media_primauf - e.stddev_primauf) THEN 'Bajo'::text
                    WHEN i.primauf >= (e.media_primauf - e.stddev_primauf) AND i.primauf <= (e.media_primauf + e.stddev_primauf) THEN 'Medio'::text
                    WHEN i.primauf > (e.media_primauf + e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM intercia i
             LEFT JOIN companias c ON i.rutcia::text = c.rutcia::text
             LEFT JOIN estadistica e ON i.periodo = e.periodo
        )
 SELECT "clsteres".periodo,
    "clsteres".rutcia,
    "clsteres".nombrecia,
    "clsteres".primauf,
    "clsteres".segmento
   FROM "clsteres";                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vista_segmentos_companias               | rutcia                        | character varying           | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rutcia,
            c.nombrecia,
            i.primauf,
                CASE
                    WHEN i.primauf < (e.media_primauf - e.stddev_primauf) THEN 'Bajo'::text
                    WHEN i.primauf >= (e.media_primauf - e.stddev_primauf) AND i.primauf <= (e.media_primauf + e.stddev_primauf) THEN 'Medio'::text
                    WHEN i.primauf > (e.media_primauf + e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM intercia i
             LEFT JOIN companias c ON i.rutcia::text = c.rutcia::text
             LEFT JOIN estadistica e ON i.periodo = e.periodo
        )
 SELECT "clsteres".periodo,
    "clsteres".rutcia,
    "clsteres".nombrecia,
    "clsteres".primauf,
    "clsteres".segmento
   FROM "clsteres";                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vista_segmentos_companias               | nombrecia                     | character varying(50)       | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rutcia,
            c.nombrecia,
            i.primauf,
                CASE
                    WHEN i.primauf < (e.media_primauf - e.stddev_primauf) THEN 'Bajo'::text
                    WHEN i.primauf >= (e.media_primauf - e.stddev_primauf) AND i.primauf <= (e.media_primauf + e.stddev_primauf) THEN 'Medio'::text
                    WHEN i.primauf > (e.media_primauf + e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM intercia i
             LEFT JOIN companias c ON i.rutcia::text = c.rutcia::text
             LEFT JOIN estadistica e ON i.periodo = e.periodo
        )
 SELECT "clsteres".periodo,
    "clsteres".rutcia,
    "clsteres".nombrecia,
    "clsteres".primauf,
    "clsteres".segmento
   FROM "clsteres";                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vista_segmentos_companias               | primauf                       | numeric                     | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rutcia,
            c.nombrecia,
            i.primauf,
                CASE
                    WHEN i.primauf < (e.media_primauf - e.stddev_primauf) THEN 'Bajo'::text
                    WHEN i.primauf >= (e.media_primauf - e.stddev_primauf) AND i.primauf <= (e.media_primauf + e.stddev_primauf) THEN 'Medio'::text
                    WHEN i.primauf > (e.media_primauf + e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM intercia i
             LEFT JOIN companias c ON i.rutcia::text = c.rutcia::text
             LEFT JOIN estadistica e ON i.periodo = e.periodo
        )
 SELECT "clsteres".periodo,
    "clsteres".rutcia,
    "clsteres".nombrecia,
    "clsteres".primauf,
    "clsteres".segmento
   FROM "clsteres";                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vista_segmentos_companias               | segmento                      | text                        | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rutcia,
            c.nombrecia,
            i.primauf,
                CASE
                    WHEN i.primauf < (e.media_primauf - e.stddev_primauf) THEN 'Bajo'::text
                    WHEN i.primauf >= (e.media_primauf - e.stddev_primauf) AND i.primauf <= (e.media_primauf + e.stddev_primauf) THEN 'Medio'::text
                    WHEN i.primauf > (e.media_primauf + e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM intercia i
             LEFT JOIN companias c ON i.rutcia::text = c.rutcia::text
             LEFT JOIN estadistica e ON i.periodo = e.periodo
        )
 SELECT "clsteres".periodo,
    "clsteres".rutcia,
    "clsteres".nombrecia,
    "clsteres".primauf,
    "clsteres".segmento
   FROM "clsteres";                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| vista_segmentos_corredores              | periodo                       | character(6)                | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rut,
            avg(i.primauf) AS promedio_primauf,
            count(i.rut) AS num_registros
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), segmentos AS (
         SELECT c.periodo,
            c.rut,
            c.promedio_primauf,
                CASE
                    WHEN c.promedio_primauf < (e.media_primauf - 1.5 * e.stddev_primauf) THEN 'Bajo'::text
                    WHEN c.promedio_primauf >= (e.media_primauf - 1.5 * e.stddev_primauf) AND c.promedio_primauf <= (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Medio'::text
                    WHEN c.promedio_primauf > (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM "clsteres" c
             LEFT JOIN estadistica e ON c.periodo = e.periodo
        )
 SELECT segmentos.periodo,
    segmentos.rut,
    segmentos.promedio_primauf,
    segmentos.segmento
   FROM segmentos;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_segmentos_corredores              | rut                           | character varying           | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rut,
            avg(i.primauf) AS promedio_primauf,
            count(i.rut) AS num_registros
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), segmentos AS (
         SELECT c.periodo,
            c.rut,
            c.promedio_primauf,
                CASE
                    WHEN c.promedio_primauf < (e.media_primauf - 1.5 * e.stddev_primauf) THEN 'Bajo'::text
                    WHEN c.promedio_primauf >= (e.media_primauf - 1.5 * e.stddev_primauf) AND c.promedio_primauf <= (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Medio'::text
                    WHEN c.promedio_primauf > (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM "clsteres" c
             LEFT JOIN estadistica e ON c.periodo = e.periodo
        )
 SELECT segmentos.periodo,
    segmentos.rut,
    segmentos.promedio_primauf,
    segmentos.segmento
   FROM segmentos;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_segmentos_corredores              | promedio_primauf              | numeric                     | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rut,
            avg(i.primauf) AS promedio_primauf,
            count(i.rut) AS num_registros
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), segmentos AS (
         SELECT c.periodo,
            c.rut,
            c.promedio_primauf,
                CASE
                    WHEN c.promedio_primauf < (e.media_primauf - 1.5 * e.stddev_primauf) THEN 'Bajo'::text
                    WHEN c.promedio_primauf >= (e.media_primauf - 1.5 * e.stddev_primauf) AND c.promedio_primauf <= (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Medio'::text
                    WHEN c.promedio_primauf > (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM "clsteres" c
             LEFT JOIN estadistica e ON c.periodo = e.periodo
        )
 SELECT segmentos.periodo,
    segmentos.rut,
    segmentos.promedio_primauf,
    segmentos.segmento
   FROM segmentos;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vista_segmentos_corredores              | segmento                      | text                        | view              |  WITH estadistica AS (
         SELECT intercia.periodo,
            avg(intercia.primauf) AS media_primauf,
            stddev(intercia.primauf) AS stddev_primauf
           FROM intercia
          GROUP BY intercia.periodo
        ), "clsteres" AS (
         SELECT i.periodo,
            i.rut,
            avg(i.primauf) AS promedio_primauf,
            count(i.rut) AS num_registros
           FROM intercia i
          GROUP BY i.periodo, i.rut
        ), segmentos AS (
         SELECT c.periodo,
            c.rut,
            c.promedio_primauf,
                CASE
                    WHEN c.promedio_primauf < (e.media_primauf - 1.5 * e.stddev_primauf) THEN 'Bajo'::text
                    WHEN c.promedio_primauf >= (e.media_primauf - 1.5 * e.stddev_primauf) AND c.promedio_primauf <= (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Medio'::text
                    WHEN c.promedio_primauf > (e.media_primauf + 1.5 * e.stddev_primauf) THEN 'Alto'::text
                    ELSE 'Indeterminado'::text
                END AS segmento
           FROM "clsteres" c
             LEFT JOIN estadistica e ON c.periodo = e.periodo
        )
 SELECT segmentos.periodo,
    segmentos.rut,
    segmentos.promedio_primauf,
    segmentos.segmento
   FROM segmentos;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |